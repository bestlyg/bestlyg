class Solution:
    def maxDistance(self, s: str, k: int) -> int:
        res = 0
        for dx in 'EW':
            for dy in 'NS':
                v1 = v2 = 0
                for c in s:
                    if c in dy or c in dx:
                        v1 += 1
                    else:
                        v2 += 1
                    d = min(v2, k)
                    res = max(res, v1 - v2 + d * 2)
        return res