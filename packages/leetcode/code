def factors(n):
    return set(
        factor for i in range(1, int(n ** 0.5) + 1) if n % i == 0
        for factor in (i, n // i)
    )
class Solution:
    def numberOfPairs(self, nums1: List[int], nums2: List[int], k: int) -> int:
        counter1 = Counter(nums1)
        counter2 = Counter(nums2)
        return sum(
            sum(counter2[v] for v in factors(num // k)) * cnt
            for num, cnt in counter1.items()
            if num % k == 0
        )