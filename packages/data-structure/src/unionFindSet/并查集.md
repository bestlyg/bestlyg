---
title: 并查集
order: 1
nav:
  title: 数据结构
  path: /data-structure
  order: 2
group:
  title: 并查集
  path: /unionFindSet
  order: 5
---

# 并查集(UnionFindSet)

## [核心代码](https://gitee.com/bestlyg/bestlyg/tree/master/packages/data-structure/src/unionFindSet/unionFindSet.ts)

```ts
export class UnionFindNode<T> {
  size = 1;
  parent: UnionFindNode<T> = this;
  constructor(public val: T) {}
}
export class UnionFind<T> {
  map = new Map<T, UnionFindNode<T>>();
  add(val: T) {
    this.map.has(val) || this.map.set(val, new UnionFindNode(val));
  }
  same(val1: T, val2: T) {
    const root1 = this.find(val1);
    const root2 = this.find(val2);
    return root1 && root2 ? root1 === root2 : false;
  }
  find(val: T): T | null {
    return this.findNode(val)?.val ?? null;
  }
  union(val1: T, val2: T) {
    const root1: UnionFindNode<T> = this.findNode(val1)!;
    const root2: UnionFindNode<T> = this.findNode(val2)!;
    if ((!root1 && !root2) || root1 === root2) return;
    if (root1.size >= root2.size) {
      root2.parent = root1;
      root1.size += root2.size;
      root2.size = 1;
    } else {
      root1.parent = root2;
      root2.size += root1.size;
      root1.size = 1;
    }
  }
  private findNode(val: T): UnionFindNode<T> | null {
    let node: UnionFindNode<T> = this.map.get(val)!;
    if (!node) return null;
    while (node.parent !== node) {
      node.parent = node.parent.parent;
      node = node.parent;
    }
    return node;
  }
}
```
